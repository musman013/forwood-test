{"_index":"2000000001.1000000001","_type":"_doc","_id":"2000000001.0443429762.2000000001.TipoDefinition.WorkPlanning","_version":892,"_score":1,"_source":{"tipo_field_groups":[{"_ARRAY_META":{"_HASH":"1462776337"},"tipo_group_name":"Approvals","tipo_fields":[{"field_type_labels":"WorkPlanApprovals","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"0311460600"},"display_name":"Work Plan Approvals","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"work_plan_approvals","sequence":1,"relationship_type":"reference","show_question_no":true,"field_type":"FieldGroup.WorkPlanApprovals"},{"field_type_labels":"ExecutionApprovals","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3029163772"},"display_name":"Work Execution Approvals","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"work_execution_approvals","visibility_expression":"$tipo_root.work_execution_status === 'Work Reviewed'","sequence":2,"relationship_type":"reference","show_question_no":true,"field_type":"FieldGroup.ExecutionApprovals"}]},{"_ARRAY_META":{"_HASH":"2681100781"},"tipo_group_name":"WorkPlanApprovals","tipo_fields":[{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1355706593"},"display_name":"Approved By","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"approved_name_approved_person_labels","sequence":2,"relationship_type":"reference","read_only":true,"show_question_no":true,"field_type":"string"},{"field_type_labels":"Digital Signature","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3648838498"},"display_name":"Signature of Approver","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"approved_signature","sequence":3,"relationship_type":"reference","show_question_no":true,"field_type":"digital_signature"},{"field_type_labels":"Date/Time","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"7883121963"},"display_name":"Date and Time","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"approval_data_time","sequence":4,"relationship_type":"reference","read_only":true,"default_value_dtnumber":24480,"show_question_no":true,"date_format":"F j, Y,  h:i K","field_type":"date_time"}]},{"_ARRAY_META":{"_HASH":"3292899835"},"tipo_group_name":"Parent","tipo_fields":[{"field_type_labels":"WorkDetails","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"6835329001"},"display_name":"Work Details","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"workdetails","sequence":1,"relationship_type":"reference","do_not_nest_data":true,"show_question_no":true,"field_type":"FieldGroup.WorkDetails"},{"field_type_labels":"Where","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"8272374648"},"display_name":"Where","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"where","sequence":2,"relationship_type":"reference","do_not_nest_data":true,"show_question_no":true,"field_type":"FieldGroup.Where"},{"field_type_labels":"PersonsInvolved","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"7559157073"},"display_name":"Persons Involved","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"personsinvolved","visibility_expression":"$tipo_root.status === 'PTW Created' || $tipo_root.status === 'Approved' || $tipo_root.status === 'Rejected' || $tipo_root.status === 'Approval Requested'","sequence":3,"relationship_type":"reference","do_not_nest_data":true,"hide_in_create":true,"show_question_no":true,"field_type":"FieldGroup.PersonsInvolved"},{"field_type_labels":"TaskDetails","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"0540783316"},"display_name":"Task Details","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"task_details","visibility_expression":"$tipo_root.status === 'PTW Created' || $tipo_root.status === 'Approval Requested' || $tipo_root.status === 'Approved' || $tipo_root.status === 'Rejected'","sequence":4,"relationship_type":"reference","do_not_nest_data":true,"show_question_no":true,"field_type":"FieldGroup.TaskDetails"},{"field_type_labels":"Approvals","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1747416369"},"display_name":"Approvals","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"approvals","visibility_expression":"$tipo_root.status === 'Approved'","sequence":5,"relationship_type":"reference","show_question_no":true,"field_type":"FieldGroup.Approvals"},{"field_type_labels":"Logs","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"5402481550"},"display_name":"Logs","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"logs","visibility_expression":"$tipo_root.status !== ''","sequence":6,"relationship_type":"reference","do_not_nest_data":true,"show_question_no":true,"field_type":"FieldGroup.Logs"}]},{"_ARRAY_META":{"_HASH":"3563426259"},"tipo_group_name":"Tasks","tipo_fields":[{"field_type_labels":"TaskDetails","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"6485347338"},"display_name":"Tasks","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"tasks","sequence":1,"hide_header":true,"relationship_type":"reference","do_not_nest_data":false,"show_question_no":true,"hidden_label":true,"field_type":"FieldGroup.TaskDetails"}]},{"_ARRAY_META":{"_HASH":"5117179969"},"tipo_group_name":"Logs","tipo_fields":[{"field_type_labels":"Rich Text","short_display":true,"mobile_width":"100","hidden_hyperlink":true,"disable_expansion":true,"read_only_in_edit":true,"_ARRAY_META":{"_HASH":"9144032923"},"tablet_width":"100","display_name":"Log","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"log","desktop_width":"100","sequence":1,"relationship_type":"reference","read_only":true,"hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"richstring"}]},{"_ARRAY_META":{"_HASH":"5250669382"},"tipo_group_name":"EmptyData","tipo_fields":[{"field_type_labels":"Text","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"7780591578"},"default_value":"-N/A-","display_name":"Empty","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"empty","sequence":1,"relationship_type":"reference","read_only":true,"show_question_no":true,"hidden_label":true,"field_type":"string"}]},{"_ARRAY_META":{"_HASH":"5409231806"},"tipo_group_name":"PersonsInvolved","tipo_fields":[{"field_type_labels":"TipoFIDUser","show_as_filter":true,"short_display":true,"tipo_field_event_js":[{"event_name":"OnChange (data_handle)","_ARRAY_META":{"_HASH":"8065670501"},"javascript_code":"data_handle.tipo.task.crew_leaders_data = [data_handle.tipo.crew_leader, ...data_handle.tipo.crew];\n// data_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i> Crew Leader is <b> Selected </b> by <b> ${tipoHandle.user_meta.name}</b>  @ ${tipoHandle.getDateUtil().format('lll')} & ${data_handle.old_value? 'Previous Crew Leader value is seleced as' + data_handle.old_value: ''} & Current Crew Leader Value is selected as <b>${data_handle.new_value}</b> </i></div>`;\n// tipoHandle.updateTipo('WorkPlanning',data_handle.tipo.tipo_id,data_handle.tipo);"}],"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1544377731"},"select_key_field":"email","select_label_field_labels":"Long Display Name","display_name":"Crew Leader","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"crew_leader","desktop_width":"40","element_style":"{'padding-right': '16px'}","select_label_field":"longDisplayName","sequence":1,"relationship_type":"reference","select_key_field_labels":"Email","show_question_no":true,"relationship_filter":"jobRoleCategory.keyword: Supervisor","field_type":"Tipo.TipoFIDUser"},{"field_type_labels":"TipoFIDUser","short_display":true,"tipo_field_event_js":[{"event_name":"OnChange (data_handle)","_ARRAY_META":{"_HASH":"2451029893"},"javascript_code":"data_handle.tipo.task.crew_leaders_data = [data_handle.tipo.crew_leader, ...data_handle.tipo.crew];"}],"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"7321211033"},"select_key_field":"email","select_label_field_labels":"Long Display Name","display_name":"Crew","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"crew","desktop_width":"60","select_label_field":"longDisplayName","sequence":2,"relationship_type":"reference","select_key_field_labels":"Email","tipo_array":true,"show_question_no":true,"relationship_filter":"jobRoleCategory.keyword: Operator","field_type":"Tipo.TipoFIDUser"}]},{"_ARRAY_META":{"_HASH":"6466273235"},"tipo_group_name":"ExecutionApprovals","tipo_fields":[{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"8104318525"},"display_name":"Approved By","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"name_approver","sequence":1,"relationship_type":"reference","read_only":true,"show_question_no":true,"field_type":"string"},{"field_type_labels":"Digital Signature","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"9363043646"},"display_name":"Signature of Approver","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"signature_of_approver","sequence":2,"relationship_type":"reference","show_question_no":true,"field_type":"digital_signature"},{"field_type_labels":"Date/Time","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"4201807134"},"display_name":"Date and Time","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"date_and_time","sequence":3,"relationship_type":"reference","read_only":true,"show_question_no":true,"date_format":"F j, Y,  h:i K","field_type":"date_time"}]},{"_ARRAY_META":{"_HASH":"7014447049"},"custom_template_config":"W10=","tipo_group_name":"LocationDetails","tipo_fields":[{"field_type_labels":"Text","field_description":"Add a location for the permit","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"2935003644"},"display_name":"Location","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"locn","element_style":"{'padding-right': '16px'}","sequence":1,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"5805496393"},"display_name":"Drawing No","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"drawing_no","element_style":"{'padding-right': '16px'}","sequence":2,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"5210763669"},"display_name":"Isolated Installations","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"isolated_installations","sequence":3,"relationship_type":"reference","show_question_no":true,"field_type":"string"}],"custom_template_css":"KiB7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7IH0gYm9keSB7bWFyZ2luOiAwO30qe2JveC1zaXppbmc6Ym9yZGVyLWJveDt9Ym9keXttYXJnaW4tdG9wOjBweDttYXJnaW4tcmlnaHQ6MHB4O21hcmdpbi1ib3R0b206MHB4O21hcmdpbi1sZWZ0OjBweDt9"},{"_ARRAY_META":{"_HASH":"8075959519"},"tipo_group_name":"Where","tipo_fields":[{"sizing":"3","field_type_labels":"TipoSSStructureMasterData","short_display":true,"tipo_field_event_js":[{"event_name":"OnChange (data_handle)","_ARRAY_META":{"_HASH":"3149640397"},"javascript_code":"const new_val = data_handle.new_value;\ndata_handle.tipo.site = new_val.site && new_val.site[0];\ndata_handle.tipo.site_labels = new_val.site_labels && new_val.site_labels[0];\ndata_handle.tipo.client = new_val.client && new_val.client[0];\ndata_handle.tipo.client_labels =new_val.client_labels && new_val.client_labels[0] !== \"Forwood Safety\" ? new_val.client_labels[0] : new_val.company_labels[0];\ndata_handle.tipo.company = new_val.company && new_val.company[0];\ndata_handle.tipo.company_labels = new_val.company_labels && new_val.company_labels[0];\ndata_handle.tipo.forwood_level = new_val.forwood_level && new_val.forwood_level[0];\ndata_handle.tipo.forwood_level_labels = new_val.forwood_level_labels && new_val.forwood_level_labels[0];\ndata_handle.tipo.structure = new_val.structure && new_val && new_val.structure[0];\ndata_handle.tipo.structure_labels = new_val.structure_labels && new_val.structure_labels[0];"}],"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1336022135"},"display_name":"Choose Project","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":false,"field_name":"hednoiaso_loc","hide_in_view":true,"sequence":1,"relationship_type":"hierarchy","show_question_no":true,"hidden_label":true,"field_type":"Tipo.TipoSSStructureMasterData"},{"field_type_labels":"Text","show_as_filter":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"9475528491"},"display_name":"Project","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"site_labels","sequence":1.4,"list_display":true,"relationship_type":"reference","read_only":true,"show_question_no":true,"field_type":"string"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1207209925"},"display_name":"Company","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"client_labels","sequence":1.5,"relationship_type":"reference","read_only":true,"show_question_no":true,"field_type":"string"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3480314677"},"display_name":"Location","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"locn","sequence":1.6,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"4523334698"},"display_name":"Client","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"client_labels","hidden_":true,"sequence":1.7,"relationship_type":"reference","read_only":true,"show_question_no":true,"field_type":"string"},{"field_type_labels":"Geo Location","short_display":true,"mobile_width":"100","hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"5217443208"},"tablet_width":"100","display_name":"Geo Location","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"geolocn","desktop_width":"100","sequence":2,"relationship_type":"reference","show_question_no":true,"field_type":"location"}]},{"_ARRAY_META":{"_HASH":"8186209766"},"tipo_group_name":"TaskDetails","tipo_fields":[{"field_type_labels":"Permit to work","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3206305239"},"display_name":"Task","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"task","sequence":1,"hide_header":true,"relationship_type":"embed","show_question_no":true,"hidden_label":true,"field_type":"Tipo.PTW"}]},{"_ARRAY_META":{"_HASH":"9962328030"},"tipo_group_name":"WorkDetails","tipo_fields":[{"field_type_labels":"Multiline Text","field_description":"Short description about the scope of work","short_display":true,"mobile_width":"100","hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"2642052393"},"tablet_width":"100","display_name":"Scope Of Work","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"scope_of_work","desktop_width":"100","sequence":1,"list_display":false,"relationship_type":"reference","show_question_no":true,"field_type":"longstring"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"0830086492"},"display_name":"Job Instructions","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"job_instructions","element_style":"{'padding-right': '16px'}","sequence":2,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Date/Time","show_as_filter":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3735105518"},"display_name":"Date  Scheduled","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"date_scheduled","element_style":"{'padding-right': '16px'}","sequence":3,"list_display":true,"only_date":false,"relationship_type":"reference","default_value_dtnumber":17940,"show_question_no":true,"date_format":"F j, Y,  h:i K","field_type":"date_time"},{"field_type_labels":"Text","field_description":"Selected Permit name","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"2498180477"},"display_name":"Work Template Description","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"permit_title","visibility_expression":"!($tipo.status === 'Submitted' || $tipo.status === 'PTW Requested' || $tipo.status === 'PTW Initiated')","sequence":4,"relationship_type":"reference","read_only":true,"hide_in_create":true,"show_question_no":true,"field_type":"string"},{"sizing":"1","field_type_labels":"Text","hide_in_edit":true,"show_as_filter":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1388667492"},"display_name":"Status","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"status","desktop_width":"30","multiple_choice":true,"element_style":"{'padding-right': '50px'}","visibility_expression":"$tipo_handle.user_meta.role !== 'Supervisor' && $tipo_handle.user_meta.role !== 'Operator'","sequence":5,"list_display":true,"relationship_type":"reference","read_only":true,"allowed_values_with_colour":[{"sequence":2,"colour":"#2D9751","_ARRAY_META":{"_HASH":"1924984117"},"value":"Submitted"},{"sequence":3,"colour":"#B34D4D","_ARRAY_META":{"_HASH":"8773593916"},"value":"PTW Requested"},{"sequence":4,"colour":"#FFA500","_ARRAY_META":{"_HASH":"1585326344"},"value":"PTW Initiated"},{"sequence":5,"colour":"#1AB399","_ARRAY_META":{"_HASH":"4788043028"},"value":"PTW Created"},{"sequence":6,"colour":"#E6B333","_ARRAY_META":{"_HASH":"4944570497"},"value":"Approval Requested"},{"sequence":6,"colour":"#00B3E6","_ARRAY_META":{"_HASH":"9369024831"},"value":"Approved"},{"sequence":7,"colour":"#FF6633","_ARRAY_META":{"_HASH":"5467438761"},"value":"Rejected"}],"hide_in_create":true,"show_question_no":true,"field_type":"string"},{"sizing":"1","field_type_labels":"Text","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"5031077009"},"display_name":"Work Execution status","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"work_execution_status","desktop_width":"30","multiple_choice":true,"element_style":"{'padding-right': '50px'}","visibility_expression":"$tipo_handle.user_meta.role === 'Supervisor' || $tipo_handle.user_meta.role === 'Operator'","sequence":5,"list_display":true,"relationship_type":"reference","read_only":true,"allowed_values_with_colour":[{"sequence":1,"colour":"#3366E6","_ARRAY_META":{"_HASH":"1924984117"},"value":"Work Execution Started"},{"sequence":2,"colour":"#638011","_ARRAY_META":{"_HASH":"8773593916"},"value":"Work Complete"},{"sequence":3,"colour":"#FF9100","_ARRAY_META":{"_HASH":"1585326344"},"value":"Work Incomplete"},{"sequence":4,"colour":"#00B1FF","_ARRAY_META":{"_HASH":"4788043028"},"value":"Work Reviewed"}],"hide_in_create":true,"show_question_no":true,"field_type":"string"},{"sizing":"3","field_type_labels":"Work Type","allow_create":false,"disable_expansion":true,"select_key_field":"tipo_id","false_alternate_label_str":"No","mandatory":true,"hidden_":false,"list_display":true,"relationship_type":"reference","tipo_array":true,"show_question_no":true,"tablet_field_width":"2","show_as_filter":false,"short_display":true,"hidden_hyperlink":true,"_ARRAY_META":{"_HASH":"3895285659"},"select_label_field_labels":"Name","display_name":"Work Type","true_alternate_label_str":"Yes","field_name":"work_type","element_style":"{'flex': $tipo_handle.mode === 'view'  ? '1 1 50% !important' : '1 1 100% !important', 'max-width': $tipo_handle.mode === 'view'  ? '50% !important' : '100% !important'}","select_label_field":"name","sequence":6,"mobile_field_width":"1","select_key_field_labels":"Work Type ID","do_not_nest_data":false,"field_type":"Tipo.WorkType"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"6098441956"},"display_name":"CheckPTWExists","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"checkptwexists","hidden_":true,"sequence":7,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Date/Time","field_description":"Enter a start date for the permit","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"9308519928"},"display_name":"Permit Start Date and Time","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"permit_start_date_and_time","desktop_width":"40","visibility_expression":"$tipo_root.status !== 'PTW Requested' && $tipo_root.status !== 'Submitted' && $tipo_root.status !== '' && $tipo_root.status !== 'PTW Initiated'","sequence":8,"relationship_type":"reference","show_question_no":true,"date_format":"F j, Y,  h:i K","field_type":"date_time"},{"field_type_labels":"Date/Time","field_description":"Enter an end date for the permit","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"8053645515"},"display_name":"Permit End Date and Time","false_alternate_label_str":"No","true_alternate_label_str":"Yes","mandatory":true,"field_name":"permit_end_date_and_time","desktop_width":"60","element_style":"{'padding-left': '16px'}","visibility_expression":"$tipo_root.status !== 'PTW Requested' && $tipo_root.status !== 'Submitted' && $tipo_root.status !== '' && $tipo_root.status !== 'PTW Initiated'","sequence":9,"relationship_type":"reference","show_question_no":true,"date_format":"F j, Y,  h:i K","field_type":"date_time"},{"sizing":"3","field_type_labels":"Text","field_description":"Add requirements needed for the permit","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"8565728641"},"display_name":"Permit Requirements","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"permit_requirements","visibility_expression":"$tipo_root.status !== 'PTW Requested' && $tipo_root.status !== 'Submitted' && $tipo_root.status !== '' && $tipo_root.status !== 'PTW Initiated'","sequence":10,"mobile_field_width":"1","relationship_type":"reference","show_question_no":true,"tablet_field_width":"2","field_type":"string"},{"value_style":"{'display': ($tipo_handle.mode === 'view' && $tipo_root.permit_locn.length < 1) ? 'block' : 'none'}","field_type_labels":"Text","hide_in_edit":false,"field_description":"Click the + button to add a new permit location","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"8260669050"},"default_value":"-N/A-","display_name":"Permit Location","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"locn_text","desktop_width":"100","visibility_expression":"$tipo_root.status !== 'PTW Requested' && $tipo_root.status !== 'Submitted' && $tipo_root.status !== '' && $tipo_root.status !== 'PTW Initiated'","sequence":11,"relationship_type":"reference","read_only":true,"hide_in_create":false,"show_question_no":true,"field_type":"string"},{"field_type_labels":"EmptyData","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"2027544175"},"default_value":"-N/A-","display_name":"Empty Data","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"empty_data","hidden_":true,"visibility_expression":"$tipo_root.status !== 'PTW Requested' && $tipo_root.status !== 'Submitted' && $tipo_root.status !== '' && $tipo_root.status !== 'PTW Initiated' && $tipo_root.permit_locn.length < 1","sequence":12,"hide_header":true,"relationship_type":"reference","read_only":true,"hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"FieldGroup.EmptyData","fill_space_invisible":true},{"sizing":"3","field_type_labels":"LocationDetails","short_display":true,"hidden_hyperlink":true,"tablet_grid":true,"disable_expansion":true,"mobile_grid":true,"_ARRAY_META":{"_HASH":"8211540059"},"display_name":"Permit Location","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"permit_locn","visibility_expression":"$tipo_root.status !== 'PTW Requested' && $tipo_root.status !== 'Submitted' && $tipo_root.status !== '' && $tipo_root.status !== 'PTW Initiated'","sequence":13,"mobile_field_width":"1","desktop_grid":true,"hide_header":true,"relationship_type":"reference","tipo_array":true,"show_question_no":true,"tablet_field_width":"2","hidden_label":true,"field_type":"FieldGroup.LocationDetails"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"4120870009"},"display_name":"ptw id","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"ptw_id","hidden_":true,"sequence":13,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Text","show_as_filter":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3334186038"},"display_name":"Work type labels","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"work_type_labels","hidden_":true,"sequence":16,"relationship_type":"reference","show_question_no":true,"field_type":"string"}]}],"tipo_event_js":[{"event_name":"OnSave (data_handle)","_ARRAY_META":{"_HASH":"1338816761"},"javascript_code":"console.log('data', data_handle);\nif(!data_handle.formControl.valid) {\n    tipoHandle.showMessage('Please fill in all the required fields before submitting the form.', '');\n    return true;  \n}\nif(data_handle.mode === 'create'){\n    data_handle.tipo.status = 'Submitted';\n    data_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i> Work Plan is <b> Created </b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')} </i></div>`;\n    data_handle.tipo.checkptwexists = tipoHandle.user_meta.email;\n} if(data_handle.mode === 'edit' && data_handle.tipo.status === 'Rejected'){\n    data_handle.tipo.status = 'PTW Created'\n}\n\nif(data_handle.mode === 'edit' && data_handle.tipo.work_execution_status === 'Work Execution Started' && data_handle.formControl.valid){\n    tipoHandle.getConfirmation('Confirmation', 'Are all steps of work execution completed?').then(function(result){\n        if (result) {\n            data_handle.tipo.work_execution_status = 'Work Complete';\n            data_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i> Work Plan Execution is <b>Completed</b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')}  </i></div>`;\n            tipoHandle.updateTipo('WorkPlanning',data_handle.tipo.tipo_id,data_handle.tipo).then(()=>{\n                data_handle.formControl.get('work_execution_status').setValue('Work Complete');\n                tipoHandle.showMessage('Work Execution Completed', '');\n            });\n        } else{\n            data_handle.tipo.work_execution_status = 'Work Incomplete';\n            data_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i> Work Plan Execution is mark as <b>Incomplete</b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')}  </i></div>`;\n            tipoHandle.updateTipo('WorkPlanning',data_handle.tipo.tipo_id,data_handle.tipo).then(()=>{\n                data_handle.formControl.get('work_execution_status').setValue('Work Incomplete');\n                tipoHandle.showMessage('Work Execution is Incomplete', '');\n\n            });\n\n        }\n    \n    });\n   \n}"},{"event_name":"OnView (data_handle)","_ARRAY_META":{"_HASH":"2998746082"},"javascript_code":"console.log('workPlanning Onview', data_handle);\nif(data_handle.tipo.permit_locn.length < 1) {\n    data_handle.tipo.locn_text = \"-N/A-\"\n}"},{"event_name":"OnList (data_handle)","_ARRAY_META":{"_HASH":"5542976117"},"javascript_code":"console.log(\"list\",data_handle)"},{"event_name":"PostServerSave (data_handle)","_ARRAY_META":{"_HASH":"9144024233"}}],"created_dt":"1682315338513","tipo_list":{"default_page_size":10,"desktop_grid":"true","enable_pagination":true,"allow_search":true,"filters":[{"hidden_":true,"filter_expression":"status.keyword:Approved","_ARRAY_META":{"_HASH":"2433037627"},"display_name":"Work Execution"}]},"application_owner_account":"2000000001","off_tipo_id":"5773686926","___commit_number___":"0c5e392b-c117-4e27-ae97-019ba9c89d2e","tipo_fields":[{"hidden_":true,"sequence":-1,"field_type_labels":"Text","_ARRAY_META":{"_HASH":"5388941325"},"display_name":"WorkPlanning ID","field_type":"string","field_name":"tipo_id"},{"field_type_labels":"Action","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"4813101423"},"display_name":"Check Existing PTW","false_alternate_label_str":"No","true_alternate_label_str":"Yes","action_settings_":{"javascript_code":"let filter =  data_handle.tipo.work_type.join(' OR ');\nlet status = \"Approved\";\ntipoHandle.getTipos('PTW', {tipo_filter:`(work_type:${filter}) AND (status_ptw:${status})`}).then((response) => {\n    var filtered = response.filter(function (el) {\n                        return el != null;\n    });\n\n    if(filtered.length > 0){\n        tipoHandle.presentTipoForm('Check PTW Exist Or Not','PTW','list',{ selecttipos: true, tipos: filtered, count: response['count'], single_select: true, key_field: 'tipo_id', hideActions: true, hideFilters: true, enableSelect: true, tipo_handle: this.tipoHandle, perm: response['perm']},[]).then((result) => {\n            if(result && result.length > 0){\n                tipoHandle.tipoInternalHandleService.startStateChange();\n                tipoHandle.getTipo('WorkPlanning',data_handle.tipo.tipo_id, {}).then((res) => {\n                console.log('tipoHnadle', tipoHandle)\n                    res.log = (data_handle.tipo.log || '') + `<div><i> Existing PTW is  <b> Checked </b> by <b> ${tipoHandle.user_meta.name}</b>  @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')} </i></div>`;\n                    res.status = 'PTW Created';\n                    res.task = result[0];\n                    res.permit_title = result[0].permit_title;\n                    tipoHandle.tipoInternalHandleService.endStateChange();\n                    tipoHandle.updateTipo('WorkPlanning',data_handle.tipo.tipo_id, res);\n                })\n            } else {\n                    tipoHandle.showMessage('Check PTW to proceed');\n            }\n        })\n    } else {\n        // tipoHandle.getTipo('WorkPlanning',data_handle.tipo.tipo_id, {}).then((res) => {\n            data_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i>  Existing PTW is  <b> Checked </b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')} </i></div>`;\n            data_handle.tipo.status = 'PTW Requested';\n            tipoHandle.updateTipo('WorkPlanning',data_handle.tipo.tipo_id, data_handle.tipo);\n            tipoHandle.showMessage('There is no PTW associated to this record. Hence sending an email to the H&S Representative');\n        // });\n        const domain = window.localStorage.getItem('server_url') ? window.localStorage.getItem('server_url') : window.location.origin +'/';\n        const WP_LINK = domain +'#/tipo/WorkPlanning/'+ data_handle.tipo.tipo_id;\n        const APP_LINK = domain +'#/login';\n        const dt = data_handle.tipo.date_scheduled;\n        const Date = dt ? tipoHandle.getDateUtil(dt).toString() : '';\n        let filter = `(jobRoleCategory.keyword:(Manager) AND (roles.keyword:SiteAdmin))`;\n        tipoHandle.getTipos('TipoFIDUser', { tipo_filter: filter }).then((res) => {\n            const users = res.count > 0 ? res.map(t => t.email) : [];\n            let subject = 'A New Work Plan is Created at ' + data_handle.tipo.site_labels+ '. Create PTW for this Work Plan' ;\n            let body = `<div><b style=\"font-size: 22px;\">Work Plan Details: </b> <br><br><br>\n                Work Plan ID: ${data_handle.tipo.tipo_id} <br>\n                Scope Of Work: ${data_handle.tipo.scope_of_work} <br> \n                Work Plan Status: ${data_handle.tipo.status} <br>\n                Company: ${data_handle.tipo.client_labels} <br>\n                Project: ${data_handle.tipo.site_labels} <br>\n                Date: ${Date} <br>\n                Description: A New Work Plan is Created, please conduct a pre-start safety meeting to \n                discuss the work to be done, the hazards involved, and the controls in place. <br><br>\n                You can view the Permit to work details <a href=\"${WP_LINK}\" target=\"_blank\" rel=\"noopener noreferrer\" data-auth=\"NotApplicable\" data-linkindex=\"5\" >here</a> <br><br><br>\n                <i>Kind Regards, <br>\n                Forwood Safety Team</i>\n                </div>`\n            tipoHandle.sendEmail(users.toString(), subject, body);\n            //tipoHandle.sendEmail('ashok.kumar@forwoodsafety.com', subject, body);\n        })\n    }\n});\nreturn true;"},"field_name":"check_existing_ptw","element_style":"{'margin-right':'16px'}","visibility_expression":"$tipo.status === 'Submitted' && (($tipo.checkptwexists === $tipo_handle.user_meta.email) || $tipo_handle.user_meta.role === 'TipoUser' || $tipo_handle.user_meta.role === 'ManagerSiteAdmin')","sequence":1,"value_class":"existingPTW btnStandard","relationship_type":"reference","hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"action"},{"field_type_labels":"Action","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"6144171685"},"display_name":"Request Approval","false_alternate_label_str":"No","true_alternate_label_str":"Yes","action_settings_":{"javascript_code":"if(data_handle.tipo.crew_leader && data_handle.tipo.crew){\ndata_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i> Work Plan Approval is <b> Requested </b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')} </i></div>`;\ndata_handle.tipo.status = 'Approval Requested';\ntipoHandle.updateTipo(data_handle.tipo_name,data_handle.tipo.tipo_id, data_handle.tipo).then((res) => {\n    if(res){\n        setTimeout(() => {\n            // data_handle.formControl.get('status').setValue('Approval Requested');\n            tipoHandle.showMessage('Approval Requested', '');\n        }, 10);\n    }\n                    let filter = `(jobRoleCategory.keyword:(Manager) AND (roles.keyword:(!SiteAdmin)))`;\n    tipoHandle.getTipos('TipoFIDUser', {tipo_filter: filter}).then((response) => { \n         const users = response.count > 0 ? response.map(t => t.email) : [];\n        //     const users = [];\n        // users.push('kriti.srivastava@forwoodsafety.com');\n        let subject = \"Work Plan is Requested for Approval\";\n          const domain = window.localStorage.getItem('server_url') ? window.localStorage.getItem('server_url') : window.location.origin +'/';\n            const WP_LINK = domain +'#/tipo/WorkPlanning/'+ data_handle.tipo.tipo_id;\n            let body = `<div><b style=\"font-size: 22px;\">Work Plan details: </b> <br><br>\n                    Work Plan ID: ${res.data.off_tipo_id} <br>\n                    Scope Of Work: ${res.data.scope_of_work} <br> \n                    Company: ${res.data.client_labels}<br>\n                    Project: ${res.data.site_labels}<br>\n                    Work Plan Status:  ${res.data.status}<br><br>\n                    You can view the Work plan Details <a href=\"${WP_LINK}\" target=\"_blank\" rel=\"noopener noreferrer\" data-auth=\"NotApplicable\" data-linkindex=\"5\" >here</a> <br><br><br>\n                    <i>Kind Regards, <br>\n                    Forwood Safety Team</i>\n                    </div>`\n        sendEmail(users, subject, body);\n    })\n})\n\nfunction sendEmail(users, subject, body) {\n                const recipents_limit = 50;\n                var a = users;\n                while(a.length) {\n                        let recipents = a.splice(0,recipents_limit);\n                        tipoHandle.sendEmail(recipents.toString(), subject, body);\n                }\n            }\n} else {\n    tipoHandle.showMessage('Please fill all the required fields in the work plan.', '');\n   // tipoHandle.toTipo('edit',data_handle.tipo.tipo_name,data_handle.tipo.tipo_id);\n    \n}\nreturn true;"},"field_name":"request_approval","element_style":"{'margin-right':'16px'}","visibility_expression":"$tipo_root.status === 'PTW Created' && (($tipo.created_by === $tipo_handle.user_meta.email) || $tipo_handle.user_meta.role === 'TipoUser'|| $tipo_handle.user_meta.role === 'ManagerSiteAdmin')","sequence":1,"value_class":"existingPTW btnStandard","relationship_type":"reference","hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"action"},{"field_type_labels":"Action","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3450354031"},"display_name":"Approve","false_alternate_label_str":"No","true_alternate_label_str":"Yes","action_settings_":{"javascript_code":"tipoHandle.presentTipoForm('','ApproverTipoForm','create',{'tipo': {}, 'hide_actions': true},[]).then((form) => {\n    if(form){\n        setTimeout(()=> {\n            tipoHandle.showMessage('Updating, Please wait...');\n        },1000)\n            tipoHandle.getTipo('WorkPlanning',data_handle.tipo.tipo_id ? data_handle.tipo.tipo_id : tipoHandle.tipoInternalHandleService.getCurrentState().tipo_id, {}).then((res) => {\n            res.log = (data_handle.tipo.log || '') + `<div><i> Work Plan is <b> Approved </b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')} </i></div>`;\n            res.status = 'Approved';\n            res.logs = res.logs + `<div><i>${form.approved_name_approved_person_labels}</i><b> Approved</b> @ ${tipoHandle.getDateUtil().format('lll')}</div>`;\n            res.approvals = {};\n            res.approvals.work_plan_approvals = form;\n            res.approvals.work_plan_approvals.approved_name_approved_person_labels = form.approved_name_approved_person_labels_labels;\n            res.approvals.work_plan_approvals.approval_data_time = form.approval_data_time;\n            res.approvals.work_plan_approvals.approved_signature = form.approved_signature;\n            let filter = `(jobRoleCategory.keyword:(Supervisor) AND !(roles.keyword:SiteAdmin))`;\n            tipoHandle.getTipos('TipoFIDUser', { tipo_filter: filter }).then((response) => {\n            const users = response.count > 0 ? response.map(t => t.email) : [];\n            // const users = [];\n            // users.push(\"kriti.srivastava@forwoodsafety.com\");\n            let subject = \"Work Plan application is approved\";\n            const domain = window.localStorage.getItem('server_url') ? window.localStorage.getItem('server_url') : window.location.origin +'/';\n            const WP_LINK = domain +'#/tipo/WorkPlanning/'+ data_handle.tipo.tipo_id;\n            let body = `<div><b style=\"font-size: 22px;\">Work Plan details: </b> <br><br><br>\n                    Work Plan ID: ${res.off_tipo_id} <br>\n                    Work Plan Title: ${res.scope_of_work} <br> \n                    Client Name: ${res.client_labels}<br>\n                    Site: ${res.site_labels}<br>\n                    Work Plan Status:  ${res.status}<br><br>\n                    You can view the Work plan Details \n                    <span><a href=\"${WP_LINK}\" target=\"_blank\" rel=\"noopener noreferrer\" data-auth=\"NotApplicable\" data-linkindex=\"5\">here</a></span><br><br><br>\n                    <i>Kind Regards, <br>\n                    Forwood Safety Team</i>\n                    </div>`\n            sendEmail(users, subject, body);\n            \n        })\n        tipoHandle.updateTipo('WorkPlanning',data_handle.tipo.tipo_id, res)\n        .then((res1) => {\n            if(res1){\n                tipoHandle.routeTo(`tipo/WorkPlanning/${data_handle.tipo.tipo_id}`,{'a':'b'},true,true);\n            }\n        })\n        })\n    }\n})\nfunction sendEmail(users, subject, body) {\n                const recipents_limit = 50;\n                var a = users;\n                while(a.length) {\n                        let recipents = a.splice(0,recipents_limit);\n                        tipoHandle.sendEmail(recipents.toString(), subject, body);\n                }\n            }\nreturn true;"},"field_name":"approve","element_style":"{'margin-right': '16px'}","visibility_expression":"$tipo_root.status == 'Approval Requested' && ($tipo_handle.user_meta.role === 'Manager' || $tipo_handle.user_meta.role === 'TipoUser'|| $tipo_handle.user_meta.role === 'ManagerSiteAdmin')","sequence":1,"value_class":"existingPTW btnStandard","relationship_type":"reference","hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"action"},{"field_type_labels":"Action","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"0559339277"},"display_name":"Reject","false_alternate_label_str":"No","true_alternate_label_str":"Yes","action_settings_":{"javascript_code":"tipoHandle.presentTipoForm(\"Reject Reason\", \"RejectIaso\",\"create\", { tipo: {}, hide_actions: true }, []).then(function(result){\n    if(result && result.reject_reason){\n        data_handle.tipo.status = 'Rejected';\n        data_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i> Work Plan is <b> Rejected </b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')} & the reject reason for this Work Plan is <b>${result.reject_reason}</b> </i></div>`;\n        tipoHandle.updateTipo('WorkPlanning', data_handle.tipo.tipo_id, data_handle.tipo).then((res) => {\n            if(res){\n                setTimeout(() => {\n                    //data_handle.formControl.get('status').setValue('Rejected');\n                       tipoHandle.showMessage('Record has been rejected'); \n                },1000)\n            }\n            const RejectReason = result.reject_reason; \n            let filter = `(jobRoleCategory.keyword:(Manager) AND (roles.keyword:SiteAdmin))`;\n            tipoHandle.getTipos('TipoFIDUser', { tipo_filter: filter }).then((response) => {\n                const users = response.count > 0 ? response.map(t => t.email) : [];\n                // const users = [];\n                users.push(data_handle.tipo.created_by);\n                // users.push(\"kriti.srivastava@forwoodsafety.com\")\n                let subject = \"Work Plan has been Rejected\";\n                  const domain = window.localStorage.getItem('server_url') ? window.localStorage.getItem('server_url') : window.location.origin +'/';\n            const WP_LINK = domain +'#/tipo/WorkPlanning/'+ data_handle.tipo.tipo_id;\n            let body = `<div><b style=\"font-size: 22px;\">Work Plan details: </b> <br><br>\n                    Work Plan ID: ${res.data.off_tipo_id} <br>\n                    Work Plan Title: ${res.data.scope_of_work} <br> \n                    Client Name: ${res.data.client_labels}<br>\n                    Site: ${res.data.site_labels}<br>\n                    Work Plan Status: ${res.data.status}<br>\n                    Reject Reason: ${RejectReason} <br><br>\n                    You can view the Work plan Details <a href=\"${WP_LINK}\" target=\"_blank\" rel=\"noopener noreferrer\" data-auth=\"NotApplicable\" data-linkindex=\"5\" >here</a> <br><br><br>\n                    <i>Kind Regards, <br>\n                    Forwood Safety Team</i>\n                    </div>`\n                    sendEmail(users, subject, body);   // we commented it bcz everytime throsten is notified, uncomment it when it went to POC\n                    // tipoHandle.sendEmail(data_handle.tipo.created_by, subject, body)\n           });\n        }); \n    }\n});\n\nfunction sendEmail(users, subject, body) {\n    const recipents_limit = 50;\n    var a = users;\n    while(a.length) {\n        let recipents = a.splice(0,recipents_limit);\n        tipoHandle.sendEmail(recipents.toString(), subject, body);\n    }\n}\n\nreturn true;"},"field_name":"reject","element_style":"{'margin-right':'16px'}","visibility_expression":"$tipo.status === 'Approval Requested' && ($tipo_handle.user_meta.role === 'Manager' || $tipo_handle.user_meta.role === 'TipoUser'|| $tipo_handle.user_meta.role === 'ManagerSiteAdmin')","sequence":1,"value_class":"rejectBtn btnStandard","relationship_type":"reference","hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"action"},{"field_type_labels":"Action","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1056218830"},"display_name":"Create new PTW","false_alternate_label_str":"No","true_alternate_label_str":"Yes","action_settings_":{"javascript_code":"console.log(\"routed\",data_handle);\nlet work_type_labels= data_handle.tipo.work_type_labels;\nlet work_type= data_handle.tipo.work_type;\nlet work_plan_id = data_handle.tipo.tipo_id;\nlet work_created_by = data_handle.tipo.created_by;\nlet dataval = {'work_type_labels':work_type_labels,'work_type':work_type,'work_plan_id':work_plan_id,'created_by':work_created_by};\nconsole.log(\"dataval\",dataval);\n\ntipoHandle.routeTo(`tipo/PTW/new`,{data:encodeURIComponent(JSON.stringify(dataval))});\nreturn true;"},"field_name":"create_new_ptw","element_style":"{'margin-right':'16px'}","visibility_expression":"$tipo.status === 'PTW Requested' && ($tipo_handle.user_meta.role === 'ManagerSiteAdmin' || $tipo_handle.user_meta.role === 'TipoUser')","sequence":1,"value_class":"existingPTW btnStandard","relationship_type":"reference","hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"action"},{"field_type_labels":"Action","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"3925725139"},"display_name":"Start Review","false_alternate_label_str":"No","true_alternate_label_str":"Yes","action_settings_":{"javascript_code":"tipoHandle.presentTipoForm('','ExecutionApproverForm','create',{'tipo': {'name_approver':data_handle.tipo.crew_leader_labels}, 'hide_actions': true},[]).then((form) => {\n  if(form){\n      setTimeout(()=> {\n          tipoHandle.showMessage('Updating, Please wait...','',3000);\n      },10)\n      tipoHandle.getTipo('WorkPlanning',data_handle.tipo.tipo_id, {}).then((res) => {\n        res.work_execution_status = 'Work Reviewed';\n        res.log = (data_handle.tipo.log || '') + `<div><i> Work Plan Execution is <b> Reviewed </b> by <b> ${data_handle.tipo.crew_leader_labels}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')} </i></div>`;\n        res.approvals.work_execution_approvals = form;\n        res.approvals.work_execution_approvals.name_approver = form.name_approver;\n        res.approvals.work_execution_approvals.signature_of_approver = form.signature_of_approver;\n        res.approvals.work_execution_approvals.date_and_time = form.date_and_time;\n        tipoHandle.updateTipo('WorkPlanning',data_handle.tipo.tipo_id, res).then((response) => {\n            if(response){\n                tipoHandle.routeTo(`tipo/WorkPlanning/${data_handle.tipo.tipo_id}`);\n            }\n        })\n      })\n  }\n})\nreturn true;"},"field_name":"start_review","visibility_expression":"($tipo.work_execution_status === 'Work Complete') && ($tipo_handle.user_meta.role === 'Supervisor' || $tipo_handle.user_meta.role === 'TipoUser')","sequence":1,"value_class":"existingPTW btnStandard","relationship_type":"reference","hide_in_create":true,"show_question_no":true,"hidden_label":true,"field_type":"action"},{"field_type_labels":"Action","hide_in_edit":true,"short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"9461584196"},"display_name":"Start Work Execution","false_alternate_label_str":"No","true_alternate_label_str":"Yes","action_settings_":{"javascript_code":"data_handle.tipo.work_execution_status = 'Work Execution Started';\r\ndata_handle.tipo.log = (data_handle.tipo.log || '') + `<div><i> Work Plan Execution is <b> Started </b> by <b> ${tipoHandle.user_meta.name}</b> @ ${data_handle.tipo.site_labels} on ${tipoHandle.getDateUtil().format('lll')}  </i></div>`;\r\ntipoHandle.updateTipo(data_handle.tipo_name,data_handle.tipo.tipo_id,data_handle.tipo).then(()=>{\r\n              tipoHandle.showMessage('Work Execution Started', '');\r\n              tipoHandle.toTipo('edit',data_handle.tipo_name,data_handle.tipo.tipo_id);\r\n                setTimeout(() => {\r\n                      document.querySelector('.mat-step-header[aria-posinset=\"4\"]').click();\r\n                }, 1000);\r\n});\r\nreturn true;"},"field_name":"start_work_execution","element_style":"{'margin':'10px'}","visibility_expression":"(($tipo_root.status === 'Approved' && $tipo.work_execution_status === '') || $tipo.work_execution_status === 'Work Incomplete') && ($tipo_handle.user_meta.role === 'Supervisor' || $tipo_handle.user_meta.role === 'TipoUser'|| $tipo_handle.user_meta.role === 'Operator')","sequence":1,"value_class":"existingPTW btnStandard","relationship_type":"reference","hide_in_create":true,"show_question_no":true,"element_style_labels":"Margin-10px","hidden_label":true,"field_type":"action"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1659234926"},"display_name":"Crew Members","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"crew_members","hidden_":true,"sequence":2,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Text","short_display":true,"hidden_hyperlink":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"6841399464"},"display_name":"tipo_filter","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"tipo_filter","hidden_":true,"sequence":9,"relationship_type":"reference","show_question_no":true,"field_type":"string"},{"field_type_labels":"Parent","short_display":true,"hidden_hyperlink":true,"show_in_wizard":true,"disable_expansion":true,"_ARRAY_META":{"_HASH":"1284484777"},"display_name":"Stepper","false_alternate_label_str":"No","true_alternate_label_str":"Yes","field_name":"workplan","sequence":20,"hide_header":true,"relationship_type":"reference","show_in_expansion_panel":false,"do_not_enforce_sequence":true,"do_not_nest_data":true,"show_question_no":true,"hidden_label":true,"field_type":"FieldGroup.Parent","wizard_direction":"Vertical","show_in_tab":false}],"created_by":"saadmin@forwoodsafety.com","application":"0443429762","hash_key":"2000000001.0443429762.2000000001.TipoDefinition.WorkPlanning","el_index":true,"updated_dt":1718699325917,"updated_by":null,"tipo_name":"TipoDefinition","tipo_id":"WorkPlanning","updated_date":"2024-06-18T08:28:45.917Z","created_date":"2023-04-24T05:48:58.513Z","account":"2000000001","tipo_meta":{"tipo_type_copy":"entity","grid_max_columns":"4","tipo_type_labels":["Simple Tipo"],"desktop_max_columns":"3","tipo_type":["entity"],"tablet_max_columns":"2","tipo_name":"WorkPlanning","mobile_max_columns":"1","display_name":"WorkPlanning","tipo_type_copy_labels":"Simple Tipo"}}}
